<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Galactic Typing Blast</title>
<style>
html,body{margin:0;padding:0;overflow:hidden;height:100%;background:#121633;}
body{font-family:'Consolas',monospace;background:#000 url('https://upload.wikimedia.org/wikipedia/commons/1/17/ESA_Hubble_Ultra_Deep_Field_part_d.png') center/cover no-repeat;}
#hud{position:absolute;top:16px;right:16px;left:16px;text-align:center;color:#f0ffff;z-index:2;}
#hud h1{margin:0;font-size:2em;color:#57c6ff;text-shadow:0 0 18px #00337a;}
#overlay,#pauseMenu{position:fixed;inset:0;display:flex;flex-direction:column;justify-content:center;align-items:center;background:rgba(12,19,39,0.88);z-index:10;}
#overlay h2,#pauseMenu h2{color:#8ce9ff;margin-bottom:18px;}
.menu-btn{padding:12px 32px;font-size:1.1em;border:none;border-radius:14px;cursor:pointer;font-family:inherit;background:#3281db;color:#fff;box-shadow:0 0 18px #00337a;}
.menu-btn:hover{background:#1bd6ff;}
.stats{color:#fff;font-size:1.2em;}
canvas{display:block;}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="hud">
  <h1>Galactic Typing Blast</h1>
  <div>Level: <span id="level">1</span> · Score: <span id="score">0</span> · EMP: <span id="emp_ready">No</span></div>
</div>
<div id="overlay">
  <h2>Galactic Typing Blast</h2>
  <div class="stats">Type space words to blast enemy ships.<br/>EMP (spacebar) after every 15 kills.<br/>If an enemy escapes, game over!</div>
  <button class="menu-btn" id="startBtn">Start Game</button>
</div>
<div id="pauseMenu" style="display:none">
  <h2>Game Paused</h2>
  <div class="stats">Press Resume to continue, or Restart to start over.</div>
  <button class="menu-btn" id="resumeBtn">Resume</button>
  <button class="menu-btn" id="restartBtn">Restart</button>
</div>
<audio id="bgmusic" src="https://cdn.pixabay.com/audio/2022/07/26/audio_122b6a03ab.mp3" loop preload="auto"></audio>
<script>
// Space/neutral word list
const wordList = [
  'galaxy','neutron','meteor','cosmos','jupiter','astronaut','probe','orbit','rocket','eclipse','asteroid','crater','telescope','launch','nebula','satellite','ufo','star','moon','planet','comet','plasma','gravity','energy','system','element',
  'phase','pulse','dream','echo','vapor','scope','sketch','blade','spark','trace','summit','craft','bullet','speed','burst','scan','flame','dust','prime','myth','plot','rhyme','scale','frost','spell','spike','steam','zone','crest','mesh',
  'hydro','blast','solar','agent','blackhole','drift','streak','orbit','quantum','stellar','silicon','apollo','sirius','venus','mars','shuttle','aster','milkyway','transit','uranus','comet','dawn','void','magnet','belt','constellation','beam','asteroid'
];
const icons = [
  function(ctx,x,y,scale=1){
    ctx.save();
    ctx.translate(x,y);ctx.scale(scale,scale);
    ctx.beginPath();ctx.arc(0,0,15,0,2*Math.PI);
    ctx.fillStyle="#b3e2ff";ctx.shadowBlur=14;ctx.shadowColor="#2cd4ff";ctx.globalAlpha=0.92;ctx.fill();
    ctx.globalAlpha=1;ctx.restore();
  },
  function(ctx,x,y,scale=1){
    ctx.save();ctx.translate(x,y);ctx.scale(scale,scale);
    ctx.beginPath();ctx.arc(0,0,11,0,2*Math.PI);
    ctx.fillStyle="#fffad3";ctx.shadowBlur=10;ctx.shadowColor="#2cd4ff";ctx.globalAlpha=0.93;ctx.fill();
    ctx.globalAlpha=1;ctx.restore();
  },
  function(ctx,x,y,scale=1){
    ctx.save();ctx.translate(x,y);ctx.scale(scale,scale);
    ctx.beginPath();ctx.moveTo(-10,10);ctx.lineTo(0,-11);ctx.lineTo(10,10);ctx.closePath();
    ctx.fillStyle="#e2f3fc";ctx.shadowBlur=7;ctx.shadowColor="#9fd7ff";ctx.globalAlpha=0.8;ctx.fill();
    ctx.globalAlpha=1;ctx.restore();
  }
];

const c=document.getElementById('c'),ctx=c.getContext('2d');
c.width=innerWidth;c.height=innerHeight;
let enemies=[],bullets=[],particles=[];
let score=0,activeEnemy=null,empAvailable=false,killstreak=0;
let player={x:c.width/2,y:c.height-80},level=1,words=[],maxLevel=8;
let gameStarted=false,paused=false,last=0,spawnTimer=0,levelTimer=0,gameOver=false;

const overlay=document.getElementById('overlay'),pauseMenu=document.getElementById('pauseMenu');
const bgmusic=document.getElementById('bgmusic');
document.getElementById('startBtn').onclick=startGame;
document.getElementById('resumeBtn').onclick=()=>{paused=false;pauseMenu.style.display='none';playMusic();};
document.getElementById('restartBtn').onclick=()=>{pauseMenu.style.display='none';startGame();};

window.addEventListener('keydown',e=>{
  if(!gameStarted||gameOver)return;
  if(e.key==='Escape' && !gameOver){
    paused=!paused;pauseMenu.style.display=paused?'flex':'none';
    if(paused) pauseMusic(); else playMusic();
  }
});

function rand(a,b){return Math.random()*(b-a)+a;}
function pickIcon() {let idx = Math.floor(rand(0,icons.length)); return icons[idx];}
function drawSpaceship(ctx,x,y,scale=1.65){
  ctx.save();ctx.translate(x,y);ctx.scale(scale,scale);
  ctx.beginPath();
  ctx.moveTo(0,-19);ctx.bezierCurveTo(-13,-18,-13,9,0,13);
  ctx.bezierCurveTo(13,9,13,-18,0,-19);
  ctx.lineTo(0,10);ctx.lineTo(-6,14);ctx.lineTo(0,20);ctx.lineTo(6,14);ctx.lineTo(0,10);
  ctx.closePath();
  ctx.fillStyle="#ffe843";
  ctx.shadowBlur=18;ctx.shadowColor="#8ce9ff";
  ctx.fill();ctx.restore();
}
function spawnEnemy(){
  if(words.length===0)return;
  const index=Math.floor(Math.random()*words.length),
    word=words.splice(index,1)[0];
  // Game level affects speed/length
  let sAdd = Math.min(level*0.09, 0.29), lenAdd = Math.min(level-1,2);
  let newWord = (word.length<6)?word+wordList[Math.floor(Math.random()*wordList.length)].slice(0,lenAdd):word;
  enemies.push({
    x:rand(75,c.width-135), y:-38, word:newWord, progress:0,
    speed:level==1?rand(0.3,0.42):rand(0.45+sAdd,0.7+sAdd), hit:false,
    draw:pickIcon()
  });
}
function drawBackground(){
  ctx.save();
  let grd=ctx.createRadialGradient(c.width/2,c.height/2,50,c.width/2,c.height/2,c.width*0.42);
  grd.addColorStop(0,"#8cfaff25");grd.addColorStop(1,"#110d29");
  ctx.globalAlpha=0.98;ctx.fillStyle=grd;ctx.fillRect(0,0,c.width,c.height);
  ctx.restore();
}
function drawEnemies(){
  enemies.forEach(e=>{
    ctx.save();
    e.draw(ctx,e.x,e.y,1.2);

    ctx.font = "bold 26px Consolas";
    ctx.textAlign = "left";
    ctx.textBaseline = "middle";
    let done = e.word.slice(0,e.progress), todo = e.word.slice(e.progress);
    let offset = ctx.measureText(done).width;

    ctx.shadowColor="#222";ctx.shadowBlur=5;
    ctx.fillStyle = "#ffe843"; // completed
    ctx.fillText(done, e.x - 28, e.y - 20);

    ctx.shadowColor="#003058";ctx.shadowBlur=6;
    ctx.fillStyle = "#f0f8ff"; // remaining
    ctx.fillText(todo, e.x - 28 + offset, e.y - 20);

    ctx.restore();
  });
}
function drawBullets(){
  bullets.forEach(b=>{
    ctx.save();
    ctx.strokeStyle="#faff57";ctx.lineWidth=2;
    ctx.shadowBlur=8;ctx.shadowColor="#ebf38c";
    ctx.beginPath();ctx.moveTo(b.x,b.y+10);ctx.lineTo(b.x,b.y);ctx.stroke();
    ctx.restore();
  });
}
function drawParticles(){
  for(let p of particles){
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,2*Math.PI);
    ctx.fillStyle=`rgba(${p.col},${p.a})`;ctx.fill();
  }
}
function drawPlayer(){drawSpaceship(ctx,player.x,player.y,1.65);}
function update(dt){
  if(!gameStarted||paused||gameOver)return;
  drawBackground();
  levelTimer+=dt/1000;
  if(levelTimer>18 && level<maxLevel){
    level++;levelTimer=0;
    document.getElementById("level").textContent=level;
  }
  // Spawn enemies, rate per level
  spawnTimer+=dt;
  if(spawnTimer>1000-(level*50)&&words.length>0){
    spawnEnemy();spawnTimer=0;
  }
  enemies.forEach(e=>e.y+=e.speed*dt*0.056);
  bullets.forEach(b=>{
    if(b.target){
      let dx=b.target.x-b.x,dy=b.target.y-b.y;
      let len=Math.hypot(dx,dy);if(len>0){dx/=len;dy/=len;}
      b.x+=dx*dt*0.43;b.y+=dy*dt*0.44;
      if(len<21){b.target.hit=true;explode(b.target.x,b.target.y);b.remove=true; playBlastSound();}
    }
    else b.y-=dt*0.64;
  });
  bullets=bullets.filter(b=>!b.remove && b.y>-18);

  enemies.forEach(e=>{
    if(e.y>player.y+22&&!e.hit){
      playExplosionSound();showGameOver();
    }
  });
  enemies=enemies.filter(e=>{
    if(e.hit){
      score+=10;killstreak++;
      document.getElementById('score').textContent=score;
      if(killstreak%15===0&&killstreak>0){empAvailable=true;document.getElementById('emp_ready').textContent='Yes';}
      return false;}
    return !gameOver;
  });
  particles.forEach(p=>{p.x+=p.vx;p.y+=p.vy;p.a-=0.021;});
  particles=particles.filter(p=>p.a>0);
}
// Sound assets
function playExplosionSound() { 
  let ctx = new (window.AudioContext||window.webkitAudioContext)();
  let o = ctx.createOscillator(), g = ctx.createGain();
  o.type='square'; o.frequency.value=90;
  g.gain.value=0.30; o.connect(g); g.connect(ctx.destination);
  o.start();
  setTimeout(()=>{g.gain.linearRampToValueAtTime(0,ctx.currentTime+0.14)},60);
  setTimeout(()=>{o.stop();ctx.close()},180);
}
function playBlastSound() {
  let ctx = new (window.AudioContext||window.webkitAudioContext)();
  let o = ctx.createOscillator(), g = ctx.createGain();
  o.type='sawtooth'; o.frequency.value=340;
  g.gain.value=0.10; o.connect(g); g.connect(ctx.destination);
  o.start();
  setTimeout(()=>{g.gain.linearRampToValueAtTime(0,ctx.currentTime+0.09)},22);
  setTimeout(()=>{o.stop();ctx.close()},100);
}
function playTypeSound() {
  let ctx = new (window.AudioContext||window.webkitAudioContext)();
  let o = ctx.createOscillator(), g = ctx.createGain();
  o.type='triangle'; o.frequency.value=650;
  g.gain.value=0.06; o.connect(g); g.connect(ctx.destination);
  o.start();
  setTimeout(()=>{g.gain.linearRampToValueAtTime(0,ctx.currentTime+0.08)},15);
  setTimeout(()=>{o.stop();ctx.close()},65);
}
function playMusic() { try{bgmusic.play();}catch(e){} }
function pauseMusic() { try{bgmusic.pause();}catch(e){} }
function explode(x,y){
  for(let i=0;i<35;i++){
    particles.push({x,y,vx:rand(-2.3,2.6),vy:rand(-2.2,2.4),r:rand(1,3.4),col:"220,255,240",a:1});
  }
}
function fireAtTarget(target){bullets.push({x:player.x,y:player.y-22,target});}
// EMP blast
function emp(){
  if(!empAvailable)return;
  enemies.forEach(e=>{explode(e.x,e.y); playBlastSound();});
  enemies=[];empAvailable=false;
  document.getElementById('emp_ready').textContent='No';
}
document.addEventListener('keydown',e=>{
  if(!gameStarted||paused||gameOver)return;
  if(e.key===" "){emp();return;}
  if(e.key==="Escape"){paused=!paused;pauseMenu.style.display=paused?'flex':'none';if(paused)pauseMusic();else playMusic();return;}
  const k=e.key.toLowerCase();
  if(!/^[a-z]$/.test(k))return;

  // Only allow typing on the actively selected enemy
  if(!activeEnemy){
    // Find only first enemy whose first letter matches NOT already started, and not hit
    activeEnemy = enemies.find(e=>e.progress===0 && e.word[0]===k && !e.hit);
    if(activeEnemy){
      fireAtTarget(activeEnemy);
      activeEnemy.progress++;
      playTypeSound();
    }
    // Typing wrong key does nothing!
    return;
  }
  // Must type correct next letter of active word only
  if(k===activeEnemy.word[activeEnemy.progress]){
    fireAtTarget(activeEnemy);
    activeEnemy.progress++;
    playTypeSound();
    if(activeEnemy.progress>=activeEnemy.word.length){
      explode(activeEnemy.x,activeEnemy.y); 
      playBlastSound();
      enemies.splice(enemies.indexOf(activeEnemy),1);
      activeEnemy=null;score+=10;killstreak++;
      document.getElementById('score').textContent=score;
      if(killstreak%15===0&&killstreak>0){empAvailable=true;document.getElementById('emp_ready').textContent='Yes';}
    }
  }else{
    // Wrong letter typed: cancel active word, no blast!
    activeEnemy=null;
  }
});
function startGame(){
  overlay.style.display='none';gameStarted=true;paused=false;gameOver=false;score=0;killstreak=0;level=1;
  enemies=[],bullets=[],particles=[],words=wordList.slice(), activeEnemy=null;
  document.getElementById('score').textContent=score;
  document.getElementById('emp_ready').textContent='No';
  document.getElementById('level').textContent=level;
  spawnTimer=0;levelTimer=0;
  playMusic();
}
function showGameOver() {
  gameOver = true; paused = false;
  pauseMusic();
  setTimeout(()=>{overlay.querySelector('h2').textContent = "Game Over";
    overlay.querySelector('.stats').textContent = "Score: "+score+". Click Start Game to play again.";
    overlay.style.display='flex';},900);
}
function loop(t){
  const dt=t-last;last=t;
  ctx.clearRect(0,0,c.width,c.height);
  update(dt); drawPlayer(); drawEnemies(); drawBullets(); drawParticles();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
window.addEventListener("resize",()=>{
  c.width=innerWidth;c.height=innerHeight;player.x=c.width/2;player.y=c.height-80;
});
</script>
</body>
</html>
